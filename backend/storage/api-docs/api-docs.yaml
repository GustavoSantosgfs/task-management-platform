openapi: 3.0.0
info:
  title: Task Management Platform API
  description: A cloud-based Task Management & Collaboration Platform API. Supports project management, task tracking with Kanban boards, notifications, and role-based access control.
  version: 1.0.0
  contact:
    email: support@example.com

servers:
  - url: http://localhost:8000/api
    description: API Server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer token. Get token via POST /auth/login

tags:
  - name: Authentication
    description: Auth endpoints for login/logout and user info
  - name: Projects
    description: Project management endpoints
  - name: Tasks
    description: Task management endpoints
  - name: Notifications
    description: Notification management endpoints

paths:
  # ============================================
  # AUTHENTICATION
  # ============================================
  /auth/login:
    post:
      tags:
        - Authentication
      summary: Login to the application
      description: Authenticate with email and password to receive a JWT token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: admin@example.com
                password:
                  type: string
                  example: password123
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      token:
                        type: string
                        example: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
                      user:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          name:
                            type: string
                            example: Admin User
                          email:
                            type: string
                            example: admin@example.com
                          role:
                            type: string
                            example: admin
                          orgId:
                            type: integer
                            example: 1
                  message:
                    type: string
                    example: Login successful
        '401':
          description: Invalid credentials

  /auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user
      description: Returns the currently authenticated user information
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User retrieved successfully
        '401':
          description: Unauthorized

  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout
      description: Logout the current user (client-side token disposal)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logout successful

  /auth/mock-users:
    get:
      tags:
        - Authentication
      summary: Get mock users
      description: Returns all available mock users for testing. Use these credentials to login.
      responses:
        '200':
          description: Mock users retrieved

  # ============================================
  # PROJECTS
  # ============================================
  /projects:
    get:
      tags:
        - Projects
      summary: List projects
      description: Get a paginated list of projects the user has access to
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
            enum: [active, on_hold, completed, archived]
        - name: visibility
          in: query
          description: Filter by visibility
          schema:
            type: string
            enum: [public, private]
        - name: search
          in: query
          description: Search by name or description
          schema:
            type: string
        - name: include_archived
          in: query
          description: Include archived projects
          schema:
            type: boolean
        - name: sort_by
          in: query
          description: Sort field
          schema:
            type: string
            enum: [name, created_at, updated_at]
        - name: sort_direction
          in: query
          description: Sort direction
          schema:
            type: string
            enum: [asc, desc]
        - name: per_page
          in: query
          description: Items per page (max 100)
          schema:
            type: integer
            default: 20
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            default: 1
      responses:
        '200':
          description: Projects retrieved successfully
        '401':
          description: Unauthorized

    post:
      tags:
        - Projects
      summary: Create project
      description: Create a new project (requires manager or admin role)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  example: New Project
                description:
                  type: string
                  example: Project description
                status:
                  type: string
                  enum: [active, on_hold, completed]
                  example: active
                visibility:
                  type: string
                  enum: [public, private]
                  example: public
                start_date:
                  type: string
                  format: date
                  example: '2024-01-01'
                end_date:
                  type: string
                  format: date
                  example: '2024-12-31'
      responses:
        '201':
          description: Project created successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '422':
          description: Validation error

  /projects/{id}:
    get:
      tags:
        - Projects
      summary: Get project
      description: Get a specific project by ID
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      responses:
        '200':
          description: Project retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Project not found

    put:
      tags:
        - Projects
      summary: Update project
      description: Update an existing project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                status:
                  type: string
                  enum: [active, on_hold, completed]
                visibility:
                  type: string
                  enum: [public, private]
                start_date:
                  type: string
                  format: date
                end_date:
                  type: string
                  format: date
      responses:
        '200':
          description: Project updated successfully
        '401':
          description: Unauthorized
        '404':
          description: Project not found
        '422':
          description: Validation error

    delete:
      tags:
        - Projects
      summary: Archive project
      description: Soft delete (archive) a project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      responses:
        '200':
          description: Project archived successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Project not found

  /projects/{id}/restore:
    post:
      tags:
        - Projects
      summary: Restore project
      description: Restore an archived project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      responses:
        '200':
          description: Project restored successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Project not found

  /projects/{id}/members:
    get:
      tags:
        - Projects
      summary: List project members
      description: Get all members of a project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      responses:
        '200':
          description: Members retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Project not found

    post:
      tags:
        - Projects
      summary: Add project member
      description: Add a user to a project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
              properties:
                user_id:
                  type: integer
                  example: 2
      responses:
        '200':
          description: Member added successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Project or user not found

  /projects/{id}/members/{memberId}:
    delete:
      tags:
        - Projects
      summary: Remove project member
      description: Remove a user from a project
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
        - name: memberId
          in: path
          required: true
          description: Member user ID
          schema:
            type: integer
      responses:
        '200':
          description: Member removed successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Project or member not found

  # ============================================
  # TASKS
  # ============================================
  /projects/{projectId}/tasks:
    get:
      tags:
        - Tasks
      summary: List tasks
      description: Get a paginated list of tasks for a project
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
            enum: [backlog, in_progress, review, completed]
        - name: priority
          in: query
          description: Filter by priority
          schema:
            type: string
            enum: [low, medium, high, critical]
        - name: assignee_id
          in: query
          description: Filter by assignee
          schema:
            type: integer
        - name: search
          in: query
          description: Search by title
          schema:
            type: string
        - name: due_date_from
          in: query
          description: Due date from
          schema:
            type: string
            format: date
        - name: due_date_to
          in: query
          description: Due date to
          schema:
            type: string
            format: date
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Tasks retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Project not found

    post:
      tags:
        - Tasks
      summary: Create task
      description: Create a new task in a project
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          description: Project ID
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  example: New Task
                description:
                  type: string
                status:
                  type: string
                  enum: [backlog, in_progress, review, completed]
                priority:
                  type: string
                  enum: [low, medium, high, critical]
                assignee_id:
                  type: integer
                due_date:
                  type: string
                  format: date
                estimated_hours:
                  type: number
      responses:
        '201':
          description: Task created successfully
        '401':
          description: Unauthorized
        '404':
          description: Project not found
        '422':
          description: Validation error

  /projects/{projectId}/tasks/{taskId}:
    get:
      tags:
        - Tasks
      summary: Get task
      description: Get a specific task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Task retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

    put:
      tags:
        - Tasks
      summary: Update task
      description: Update an existing task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                description:
                  type: string
                status:
                  type: string
                  enum: [backlog, in_progress, review, completed]
                priority:
                  type: string
                  enum: [low, medium, high, critical]
                assignee_id:
                  type: integer
                due_date:
                  type: string
                  format: date
                estimated_hours:
                  type: number
      responses:
        '200':
          description: Task updated successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found
        '422':
          description: Validation error

    delete:
      tags:
        - Tasks
      summary: Delete task
      description: Delete a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Task deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

  /projects/{projectId}/tasks/{taskId}/restore:
    post:
      tags:
        - Tasks
      summary: Restore task
      description: Restore a deleted task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Task restored successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

  /my-tasks:
    get:
      tags:
        - Tasks
      summary: Get my tasks
      description: Get tasks assigned to the current user
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
        - name: priority
          in: query
          description: Filter by priority
          schema:
            type: string
        - name: project_id
          in: query
          description: Filter by project
          schema:
            type: integer
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Tasks retrieved successfully
        '401':
          description: Unauthorized

  /projects/{projectId}/tasks/{taskId}/dependencies:
    get:
      tags:
        - Tasks
      summary: List task dependencies
      description: Get all dependencies for a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Dependencies retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

    post:
      tags:
        - Tasks
      summary: Add task dependency
      description: Add a dependency to a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - depends_on_task_id
              properties:
                depends_on_task_id:
                  type: integer
                  example: 2
      responses:
        '200':
          description: Dependency added successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

  /projects/{projectId}/tasks/{taskId}/dependencies/{dependencyId}:
    delete:
      tags:
        - Tasks
      summary: Remove task dependency
      description: Remove a dependency from a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
        - name: dependencyId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Dependency removed successfully
        '401':
          description: Unauthorized
        '404':
          description: Task or dependency not found

  /projects/{projectId}/tasks/{taskId}/comments:
    get:
      tags:
        - Tasks
      summary: List task comments
      description: Get all comments for a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Comments retrieved successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

    post:
      tags:
        - Tasks
      summary: Add task comment
      description: Add a comment to a task
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  example: This is a comment
                mentions:
                  type: array
                  items:
                    type: integer
      responses:
        '201':
          description: Comment added successfully
        '401':
          description: Unauthorized
        '404':
          description: Task not found

  /projects/{projectId}/tasks/{taskId}/comments/{commentId}:
    put:
      tags:
        - Tasks
      summary: Update task comment
      description: Update an existing comment
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
        - name: commentId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                mentions:
                  type: array
                  items:
                    type: integer
      responses:
        '200':
          description: Comment updated successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Comment not found

    delete:
      tags:
        - Tasks
      summary: Delete task comment
      description: Delete a comment
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
        - name: taskId
          in: path
          required: true
          schema:
            type: integer
        - name: commentId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Comment deleted successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Comment not found

  # ============================================
  # NOTIFICATIONS
  # ============================================
  /notifications:
    get:
      tags:
        - Notifications
      summary: List notifications
      description: Get paginated notifications for the current user
      security:
        - bearerAuth: []
      parameters:
        - name: unread_only
          in: query
          description: Only unread notifications
          schema:
            type: boolean
        - name: read_only
          in: query
          description: Only read notifications
          schema:
            type: boolean
        - name: type
          in: query
          description: Filter by notification type
          schema:
            type: string
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Notifications retrieved successfully
        '401':
          description: Unauthorized

  /notifications/unread-count:
    get:
      tags:
        - Notifications
      summary: Get unread count
      description: Get the count of unread notifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Unread count retrieved
        '401':
          description: Unauthorized

  /notifications/mark-all-read:
    post:
      tags:
        - Notifications
      summary: Mark all as read
      description: Mark all notifications as read
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All notifications marked as read
        '401':
          description: Unauthorized

  /notifications/read:
    delete:
      tags:
        - Notifications
      summary: Delete all read
      description: Delete all read notifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Read notifications deleted
        '401':
          description: Unauthorized

  /notifications/{id}:
    get:
      tags:
        - Notifications
      summary: Get notification
      description: Get a specific notification
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Notification retrieved
        '401':
          description: Unauthorized
        '404':
          description: Notification not found

    delete:
      tags:
        - Notifications
      summary: Delete notification
      description: Delete a notification
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Notification deleted
        '401':
          description: Unauthorized
        '404':
          description: Notification not found

  /notifications/{id}/read:
    post:
      tags:
        - Notifications
      summary: Mark as read
      description: Mark a notification as read
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Notification marked as read
        '401':
          description: Unauthorized
        '404':
          description: Notification not found

  /notifications/{id}/unread:
    post:
      tags:
        - Notifications
      summary: Mark as unread
      description: Mark a notification as unread
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Notification marked as unread
        '401':
          description: Unauthorized
        '404':
          description: Notification not found
